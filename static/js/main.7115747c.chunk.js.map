{"version":3,"sources":["components/OD.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Buttons","isCameraEnable","setCameraEnable","isCaptured","setCaptured","setShutter","shutter","facingMode","setFacingMode","processing","isBackgroundEnable","setBackgroundEnable","style","display","justifyContent","alignItems","IconButton","disabled","color","onClick","Switch","defaultChecked","Canvas","webcamRef","width","height","setProcessing","screenshotRef","useRef","drawCanvasRef","useState","setModel","Image","screenshot","setScreenshot","canvasRef","GetScreenshot","a","console","log","current","webcamCurrent","video","readyState","imgSrc","getScreenshot","img","src","onload","DrawCanvas","naturalWidth","naturalHeight","context","getContext","drawImage","LoadModel","cocoSsd","cocossd","useEffect","border","audio","ref","videoConstraints","margin","textAlign","zIndex","CircularProgress","ObjectDetector","setBackgroudEnable","getWindowDimensions","window","innerWidth","innerHeight","windowDimensions","setWindowDimensions","onResize","addEventListener","removeEventListener","UseWindowDimensions","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7115747c.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport Switch from '@material-ui/core/Switch';\nimport { IconButton } from '@material-ui/core';\nimport FlipCameraIosIcon from '@material-ui/icons/FlipCameraIos';\nimport CameraAltIcon from '@material-ui/icons/CameraAlt';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Webcam from 'react-webcam';\nimport '@tensorflow/tfjs-backend-cpu';\nimport * as cocoSsd from '@tensorflow-models/coco-ssd';\n\nconst UseWindowDimensions = () => {\n    const getWindowDimensions = () => {\n        const { innerWidth: width, innerHeight: height } = window;\n        return { width, height }\n    }\n    const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\n    useEffect(() => {\n        const onResize = () => {\n            setWindowDimensions(getWindowDimensions());\n        }\n        window.addEventListener('resize', onResize);\n        return () => window.removeEventListener('resize', onResize);\n    }, []);\n    return windowDimensions;\n}\n\ninterface ButtonsProps {\n    isCameraEnable: boolean\n    setCameraEnable: Function\n    isCaptured: boolean\n    setCaptured: Function\n    shutter: boolean\n    setShutter: Function\n    facingMode: string\n    setFacingMode: Function\n    isBackgroundEnable: boolean\n    setBackgroundEnable: Function\n    processing: boolean\n}\nconst Buttons: React.FC<ButtonsProps> = ({\n    isCameraEnable,\n    setCameraEnable,\n    isCaptured,\n    setCaptured,\n    shutter,\n    setShutter,\n    facingMode,\n    setFacingMode,\n    isBackgroundEnable,\n    setBackgroundEnable,\n    processing\n}) => {\n    return (\n        <div\n            style={{\n                display: 'flex',\n                justifyContent: 'space-around',\n                alignItems: 'center'\n            }}\n        >\n            {/* camera start or capture button */}\n            <IconButton disabled={processing}>\n                {isCaptured ||\n                    <CameraAltIcon color={processing ? 'disabled' : 'primary'} onClick={() => setShutter(true)}/>\n                }\n                {isCaptured &&\n                    <CameraAltIcon color={processing ? 'disabled' : 'primary'} onClick={() => setCaptured(false)}/>\n                }\n            </IconButton>\n\n            {/* select camera */}\n            <IconButton disabled={isCaptured || processing}>\n                {(isCaptured) && \n                    <FlipCameraIosIcon color='disabled'/>\n                }\n                {isCaptured ||\n                    <>\n                        {facingMode === 'user' &&\n                            <FlipCameraIosIcon color={processing ? 'disabled' : 'primary'} onClick={() => setFacingMode('environment')}/>\n                        }\n                        {facingMode === 'environment' &&\n                            <FlipCameraIosIcon color={processing ? 'disabled' : 'primary'} onClick={() => setFacingMode('user')}/>\n                        }\n                    </>\n                }\n            </IconButton>\n\n            {/* background */}\n            <Switch defaultChecked color='primary' disabled={!isCaptured} />\n\n            {/* upload */}\n            <IconButton disabled={true}>\n                <CloudUploadIcon color='disabled'/>\n            </IconButton>\n        </div>\n    );\n}\n\ninterface CanvasProps {\n    webcamRef: any\n    facingMode: string\n    width: number\n    height: number\n    isCaptured: boolean\n    setCaptured: Function\n    shutter: boolean\n    setShutter: Function\n    processing: boolean\n    setProcessing: Function\n}\n\nconst Canvas: React.FC<CanvasProps> = ({\n    webcamRef,\n    facingMode,\n    width,\n    height,\n    isCaptured,\n    setCaptured,\n    shutter,\n    setShutter,\n    processing,\n    setProcessing\n}) => {\n    const screenshotRef = useRef(true);\n    const drawCanvasRef = useRef(true);\n    const [model, setModel] = useState<any>(null);\n    const [screenshot, setScreenshot] = useState<HTMLImageElement>(new Image);\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n    const GetScreenshot = async () => {\n        console.log('start screenshot.');\n        if (webcamRef.current) {\n            const webcamCurrent = webcamRef.current as any;\n            console.log('webcam ready.')\n            if (webcamCurrent.video.readyState === 4) {\n                const imgSrc = webcamRef.current?.getScreenshot();\n                let img = new Image;\n                img.src = imgSrc;\n                img.onload = () => {\n                    console.log('end screenshot.');\n                    setScreenshot(img);\n                    setShutter(false);\n                    setCaptured(true);\n                }\n            }\n        }\n    }\n    const DrawCanvas = async () => {\n        if (isCaptured) {\n            if (canvasRef.current) {\n                console.log('canvas ready.');\n                canvasRef.current.width = screenshot.naturalWidth;\n                canvasRef.current.height = screenshot.naturalHeight;\n                const context = canvasRef.current.getContext('2d');\n                context?.drawImage(screenshot, 0, 0);\n                console.log('drawn.');\n            }\n        }\n        /*\n        setProcessing(true);\n        if (isCaptured) {\n            if (webcamRef.current && canvasRef.current) {\n                console.log('webcam and canvas are ready.');\n                const webcamCurrent = webcamRef.current as any;\n                const ctx = canvasRef.current.getContext('2d');\n                await setTimeout(() => {\n                    console.log('wait')\n                    console.log(webcamCurrent.video.readyState);\n                    if (webcamCurrent.video.readyState === 4) {\n                        console.log('webcam current ready state is 4.');\n                        const imgSrc = webcamRef.current?.getScreenshot();\n                        let img = new Image;\n                        img.src = imgSrc;\n                        console.log(img);\n                        ctx?.drawImage(img, 0, 0);\n\n                        setProcessing(false);\n                    }\n                }, 100);\n            }\n        }\n        */\n    }\n    const LoadModel = async () => {\n        console.log('start model loading.');\n        setProcessing(true);\n        const cocossd = await cocoSsd.load();\n        setModel(cocossd);\n        setProcessing(false);\n        console.log('model loaded.')\n    }\n    useEffect(() => {\n        LoadModel();\n    }, []);\n\n    useEffect(() => {\n        if (screenshotRef.current) {\n            screenshotRef.current = false;\n            return;\n        }\n        GetScreenshot();\n    }, [shutter]);\n\n    useEffect(() => {\n        if (drawCanvasRef.current) {\n            drawCanvasRef.current = false;\n            return;\n        }\n        DrawCanvas();\n    }, [isCaptured])\n\n    console.log('shutter', shutter, 'processing', processing, 'isCaptured', isCaptured, 'condition', (isCaptured && !processing));\n    return (\n        <div \n            style={{\n                width: width, \n                height: height*0.9,\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                border: '1px solid',\n            }}\n        >\n            {(!isCaptured && !processing) &&\n                <Webcam\n                    audio={false}\n                    ref={webcamRef}\n                    videoConstraints={{\n                        facingMode: facingMode\n                    }}\n                    style={{\n                        margin: 'auto',\n                        textAlign: 'center',\n                        zIndex: 9,\n                        width: '100%',\n                        height: '100%'\n                    }}\n                />\n            }\n            {processing && \n                <CircularProgress \n                />\n            }\n            {(isCaptured && !processing) && \n                <>\n                    <canvas\n                        ref={canvasRef}\n                        style={{\n                            margin: 'auto',\n                            width: '100%',\n                            height: '100%',\n                            border: '1px solid',\n                            zIndex: 30\n                        }}\n                    />\n                </>\n            }\n        </div>\n    );\n}\n\nexport const ObjectDetector: React.FC = () => {\n    const [isCameraEnable, setCameraEnable] = useState<boolean>(true);\n    const [isCaptured, setCaptured] = useState<boolean>(false);\n    const [shutter, setShutter] = useState<boolean>(false);\n    const [isBackgroundEnable, setBackgroudEnable] = useState<boolean>(true);\n    const [facingMode, setFacingMode] = useState<string>('user');\n    const [processing, setProcessing] = useState<boolean>(false);\n    const { width, height } = UseWindowDimensions();\n    const webcamRef = useRef<Webcam>(null);\n    return (\n        <div>\n            <Buttons\n                isCameraEnable={isCameraEnable}\n                setCameraEnable={setCameraEnable}\n                isCaptured={isCaptured}\n                setCaptured={setCaptured}\n                shutter={shutter}\n                setShutter={setShutter}\n                facingMode={facingMode}\n                setFacingMode={setFacingMode}\n                isBackgroundEnable={isBackgroundEnable}\n                setBackgroundEnable={setBackgroudEnable}\n                processing={processing}\n            />\n            <Canvas\n                webcamRef={webcamRef}\n                facingMode={facingMode}\n                width={width}\n                height={height}\n                isCaptured={isCaptured}\n                setCaptured={setCaptured}\n                shutter={shutter}\n                setShutter={setShutter}\n                processing={processing}\n                setProcessing={setProcessing}\n            />\n        </div>\n    );\n}","import React from 'react';\n// import { Detector } from './components/Detector';\n// import { Camera } from './components/Webcam';\nimport { ObjectDetector } from './components/OD';\n\nconst App: React.FC = () => {\n  return (\n    <div>\n      {/* <Detector /> */}\n      {/* <Camera /> */}\n      <ObjectDetector />\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}