(this["webpackJsonpts-app"]=this["webpackJsonpts-app"]||[]).push([[0],{284:function(e,t,n){},290:function(e,t){},291:function(e,t){},299:function(e,t){},310:function(e,t,n){"use strict";n.r(t);var r=n(7),a=n.n(r),c=n(118),i=n.n(c),s=(n(284),n(6)),o=n(104),u=n(40),d=n(8),l=n.n(d),j=n(12),b=n(332),g=n(330),h=n(124),f=n.n(h),O=n(105),p=n.n(O),m=n(272),v=n.n(m),x=n(331),w=n(106),C=n.n(w),y=(n(308),n(136)),S=n(328),k=n(329),z=n(271),E=n.n(z),M=n(19),I=function(e){var t=e.children,n=e.title;return console.log(n),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{children:t}),Object(M.jsxs)(S.a,{showLabels:!0,value:n,children:[Object(M.jsx)(k.a,{component:o.b,to:"/tfjs/segmentation",value:"segmentation",label:"photo",icon:Object(M.jsx)(p.a,{})}),Object(M.jsx)(k.a,{component:o.b,to:"/tfjs/settings",value:"settings",label:"settings",icon:Object(M.jsx)(E.a,{})})]})]})},B=function(e){e.isCameraEnable,e.setCameraEnable;var t=e.isCaptured,n=e.setCaptured,r=(e.shutter,e.setShutter),a=(e.isDetected,e.setDetected),c=e.facingMode,i=e.setFacingMode,s=e.isBackgroundEnable,o=e.setBackgroundEnable,u=e.processing;return Object(M.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center"},children:[Object(M.jsxs)(g.a,{disabled:u,children:[t||Object(M.jsx)(p.a,{color:u?"disabled":"primary",onClick:function(){return r(!0)}}),t&&Object(M.jsx)(p.a,{color:u?"disabled":"primary",onClick:function(){n(!1),a(!1)}})]}),Object(M.jsxs)(g.a,{disabled:t||u,children:[t&&Object(M.jsx)(f.a,{color:"disabled"}),t||Object(M.jsxs)(M.Fragment,{children:["user"===c&&Object(M.jsx)(f.a,{color:u?"disabled":"primary",onClick:function(){return i("environment")}}),"environment"===c&&Object(M.jsx)(f.a,{color:u?"disabled":"primary",onClick:function(){return i("user")}})]})]}),Object(M.jsx)(b.a,{defaultChecked:!0,color:"primary",disabled:!t,onChange:function(){return o(!s)}}),Object(M.jsx)(g.a,{disabled:!0,children:Object(M.jsx)(v.a,{color:"disabled"})})]})},F=function(e){var t=e.webcamRef,n=e.facingMode,a=e.width,c=e.height,i=e.isCaptured,o=e.setCaptured,u=e.isBackgroundEnable,d=e.shutter,b=e.setShutter,g=e.isDetected,h=e.setDetected,f=e.processing,O=e.setProcessing,p=(e.capturedTime,e.setCapturedTime),m=(e.peopleCount,e.setPeopleCount,e.background),v=e.cameraSize,w=e.setCameraSize,S=Object(r.useRef)(!0),k=Object(r.useRef)(!0),z=Object(r.useRef)(!0),E=Object(r.useState)(null),I=Object(s.a)(E,2),B=I[0],F=I[1],R=Object(r.useState)(null),D=Object(s.a)(R,2),T=D[0],H=D[1],W=Object(r.useState)(new Image),L=Object(s.a)(W,2),P=L[0],A=L[1],J=Object(r.useRef)(null),N=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("start getting camera size."),setTimeout((function(){if(t.current){var e=t.current;if(console.log("webcam ready."),console.log(e.video.readyState),4===e.video.readyState){var n,r=null===(n=t.current)||void 0===n?void 0:n.getScreenshot(),a=new Image;a.src=r,a.onload=function(){console.log("natural width: "+a.naturalWidth),console.log("natural height: "+a.naturalHeight),w([a.naturalWidth,a.naturalHeight]),console.log("cameraSize: "+v),console.log("end getting camera size.")}}}}),2e3);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("start screenshot."),setTimeout((function(){if(t.current){var e=t.current;if(console.log("webcam ready."),4===e.video.readyState){var n,r=null===(n=t.current)||void 0===n?void 0:n.getScreenshot(),a=new Image;a.src=r;var c=new Date;p(c.getFullYear()+"/"+(c.getMonth()+1)+"/"+c.getDate()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()),a.onload=function(){console.log("end screenshot."),A(a),console.log("screenshot width: "+a.naturalWidth),console.log("screenshot height: "+a.naturalHeight),b(!1),o(!0)}}}}),2e3);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H(null),!i){e.next=12;break}return console.log("detect start."),O(!0),"full",e.next=7,B.segmentMultiPerson(P,{internalResolution:"full"});case 7:t=e.sent,console.log("detect end."),t.length?(console.log(t),H(t)):console.log("no detection."),O(!1),h(!0);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(j.a)(l.a.mark((function e(){var t,n,r,a,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i&&J.current&&(console.log("canvas ready."),console.log(J.current.width),console.log(P.naturalWidth),J.current.width=P.naturalWidth,J.current.height=P.naturalHeight,.7,!1,0,t=J.current,T?(n={r:255,g:0,b:0,a:255},r={r:0,g:0,b:0,a:0},a=y.c(T,n,r),u?y.a(t,P,a,.7,0,false):y.a(t,m,a,.7,0,false),(c=t.getContext("2d"))&&(c.fillStyle="red",c.fillText("count: "+Object.keys(T).length,10,10))):(s=J.current.getContext("2d"))&&(u?s.drawImage(P,0,0):s.drawImage(m,0,0)),console.log("drawn."));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("start model loading."),O(!0),"MobileNetV1",16,2,e.next=7,y.b({architecture:"MobileNetV1",outputStride:16,quantBytes:2});case 7:t=e.sent,F(t),O(!1),console.log("model loaded.");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){f||0===Object.keys(v).length&&N()}),[f]),Object(r.useEffect)((function(){G()}),[]),Object(r.useEffect)((function(){S.current?S.current=!1:V()}),[d]),Object(r.useEffect)((function(){k.current?k.current=!1:q()}),[i]),Object(r.useEffect)((function(){z.current?z.current=!1:Y()}),[g,u]),console.log("shutter",d,"processing",f,"isCaptured",i,"condition",i&&!f),Object(M.jsxs)("div",{style:{width:a,height:.8*c,display:"flex",justifyContent:"center",alignItems:"center"},children:[!d&&!i&&!f&&0===Object.keys(v).length&&Object(M.jsx)(C.a,{audio:!1,ref:t,videoConstraints:{facingMode:n},style:{margin:"auto",textAlign:"center",zIndex:9,visibility:"hidden"}}),!d&&!i&&!f&&2===Object.keys(v).length&&Object(M.jsx)(C.a,{audio:!1,ref:t,videoConstraints:{facingMode:n},style:{margin:"auto",textAlign:"center",zIndex:9,width:"100%",height:"100%"}}),d&&!i&&!f&&2===Object.keys(v).length&&Object(M.jsx)(C.a,{audio:!1,ref:t,videoConstraints:{facingMode:n},style:{margin:"auto",textAlign:"center",zIndex:9,width:v[0],height:v[1],visibility:"hidden"}}),f&&Object(M.jsx)(x.a,{}),i&&!f&&Object(M.jsx)(M.Fragment,{children:Object(M.jsx)("canvas",{ref:J,style:{margin:"auto",width:"100%",height:"100%",zIndex:30}})})]})},R=function(e){var t=e.background,n=e.cameraSize,a=e.setCameraSize,c=Object(r.useState)(!0),i=Object(s.a)(c,2),o=i[0],u=i[1],d=Object(r.useState)(!1),l=Object(s.a)(d,2),j=l[0],b=l[1],g=Object(r.useState)(!1),h=Object(s.a)(g,2),f=h[0],O=h[1],p=Object(r.useState)(!1),m=Object(s.a)(p,2),v=m[0],x=m[1],w=Object(r.useState)(!0),C=Object(s.a)(w,2),y=C[0],S=C[1],k=Object(r.useState)("user"),z=Object(s.a)(k,2),E=z[0],R=z[1],D=Object(r.useState)(!1),T=Object(s.a)(D,2),H=T[0],W=T[1],L=Object(r.useState)(""),P=Object(s.a)(L,2),A=P[0],J=P[1],N=Object(r.useState)(0),V=Object(s.a)(N,2),q=V[0],Y=V[1],G=function(){var e=function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}},t=Object(r.useState)(e()),n=Object(s.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){var t=function(){c(e())};return window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}),[]),a}(),K=G.width,Q=G.height,U=Object(r.useRef)(null);return Object(M.jsxs)(I,{title:"segmentation",children:[Object(M.jsx)(B,{isCameraEnable:o,setCameraEnable:u,isCaptured:j,setCaptured:b,shutter:f,setShutter:O,isDetected:v,setDetected:x,facingMode:E,setFacingMode:R,isBackgroundEnable:y,setBackgroundEnable:S,processing:H}),Object(M.jsx)(F,{webcamRef:U,facingMode:E,width:K,height:Q,isCaptured:j,setCaptured:b,isBackgroundEnable:y,shutter:f,setShutter:O,isDetected:v,setDetected:x,processing:H,setProcessing:W,capturedTime:A,setCapturedTime:J,peopleCount:q,setPeopleCount:Y,background:t,cameraSize:n,setCameraSize:a})]})},D=function(e){var t=e.isCaptured,n=e.setCaptured,r=e.facingMode,a=e.setFacingMode,c=(e.shutter,e.setShutter);return Object(M.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center"},children:[Object(M.jsx)(g.a,{children:Object(M.jsx)(p.a,{color:"primary",onClick:function(){t?n(!1):c(!0)}})}),Object(M.jsx)(g.a,{disabled:t,children:Object(M.jsx)(f.a,{color:t?"disabled":"primary",onClick:function(){"user"===r?a("environment"):"environment"===r&&a("user")}})})]})},T=function(e){var t=e.webcamRef,n=e.isCaptured,a=e.setCaptured,c=e.facingMode,i=e.shutter,s=e.setShutter,o=e.background,u=e.setBackground,d=e.width,b=e.height,g=e.cameraSize,h=Object(r.useRef)(null),f=Object(r.useRef)(!0),O=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout((function(){if(t.current){var e=t.current;if(console.log("webcam ready."),4===e.video.readyState){var n,r=null===(n=t.current)||void 0===n?void 0:n.getScreenshot(),c=new Image;c.src=r,c.onload=function(){u(c),console.log("background width: "+o.naturalWidth),console.log("background height: "+o.naturalHeight),s(!1),a(!0)}}}}),2e3);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&h.current&&(h.current.width=o.naturalWidth,h.current.height=o.naturalHeight,null===(t=h.current.getContext("2d"))||void 0===t||t.drawImage(o,0,0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){f.current?f.current=!1:O()}),[i]),Object(r.useEffect)((function(){p()}),[n]),Object(M.jsxs)("div",{style:{width:d,height:.8*b,display:"flex",justifyContent:"center",alignItems:"center"},children:[!i&&!n&&Object(M.jsx)(C.a,{audio:!1,ref:t,videoConstraints:{facingMode:c},style:{margin:"auto",textAlign:"center",zIndex:9,width:"100%",height:"100%"}}),i&&!n&&Object(M.jsx)(C.a,{audio:!1,ref:t,videoConstraints:{facingMode:c},style:{margin:"auto",textAlign:"center",zIndex:9,width:g[0],height:g[1],visibility:"hidden"}}),n&&Object(M.jsx)(M.Fragment,{children:Object(M.jsx)("canvas",{ref:h,style:{margin:"auto",width:"100%",height:"100%",zIndex:30}})})]})},H=function(e){var t=e.background,n=e.setBackground,a=e.cameraSize,c=function(){var e=function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}},t=Object(r.useState)(e()),n=Object(s.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){var t=function(){c(e())};return window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}),[]),a}(),i=c.width,o=c.height,u=Object(r.useState)(!1),d=Object(s.a)(u,2),l=d[0],j=d[1],b=Object(r.useState)("user"),g=Object(s.a)(b,2),h=g[0],f=g[1],O=Object(r.useState)(!1),p=Object(s.a)(O,2),m=p[0],v=p[1],x=Object(r.useRef)(null);return Object(M.jsxs)(I,{title:"settings",children:[Object(M.jsx)(D,{isCaptured:l,setCaptured:j,facingMode:h,setFacingMode:f,shutter:m,setShutter:v}),Object(M.jsx)(T,{webcamRef:x,isCaptured:l,setCaptured:j,facingMode:h,shutter:m,setShutter:v,background:t,setBackground:n,width:i,height:o,cameraSize:a})]})},W=function(){var e=Object(r.useState)(new Image),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),i=Object(s.a)(c,2),d=i[0],l=i[1];return Object(M.jsx)(o.a,{children:Object(M.jsxs)(u.c,{children:[Object(M.jsx)(u.a,{path:"/tfjs/segmentation",children:Object(M.jsx)(R,{background:n,cameraSize:d,setCameraSize:l})}),Object(M.jsx)(u.a,{path:"/tfjs/settings",children:Object(M.jsx)(H,{background:n,setBackground:a,cameraSize:d})})]})})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,333)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};i.a.render(Object(M.jsx)(a.a.StrictMode,{children:Object(M.jsx)(o.a,{basename:"/tfjs",children:Object(M.jsx)(W,{})})}),document.getElementById("root")),L()}},[[310,1,2]]]);
//# sourceMappingURL=main.3a286e2f.chunk.js.map